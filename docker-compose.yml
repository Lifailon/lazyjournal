services:
  lazyjournal:
    image: lifailon/lazyjournal:latest
    build:
      context: .
      dockerfile: Dockerfile
    container_name: lazyjournal
    restart: unless-stopped
    # Grant read permissions (:ro) from the host system
    volumes:
      # Systemd
      - /run/dbus/system_bus_socket:/run/dbus/system_bus_socket:ro
      - /run/systemd/system:/run/systemd/system:ro
      - /run/systemd/journal/socket:/run/systemd/journal/socket:ro
      # Journald
      - /etc/machine-id:/etc/machine-id:ro
      # Filesystem
      - /var/log:/var/log:ro
      - /opt:/opt:ro
      - /home:/home:ro
      # Docker socket
      - /var/run/docker.sock:/var/run/docker.sock:ro
      # Read docker logs from filesystem
      - /var/lib/docker/containers:/var/lib/docker/containers:ro
      # Kubernetes configuration (optional) for kubectl
      # - /etc/rancher/k3s/k3s.yaml:/root/.kube/config
      # Custom lazyjournal configuration (optional)
      - ./config.yml:/bin/config.yml:ro
    privileged: true
    # Remove if not using Web mode
    ports:
      - "${PORT}:${PORT}"
    env_file:
      - .env
    # Remove if not using TUI mode
    tty: true
    stdin_open: true